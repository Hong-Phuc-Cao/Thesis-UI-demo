import{_ as H,S as u,b as _,A as p,c as h,d as f,a as t,e as r,w as d,v as N,F as g,g as k,f as C,o as s,t as m,y as M,z as b}from"./index-DsFX8v4I.js";import{l as K,a as T,s as V}from"./so-sanh-nam-s7tHrirU.js";const w={props:{isOpen:Boolean},data(){return{hienKetQua:!1,MaGV:"",MaCV:"",MaNV:"",HocKy:"",NamHoc:"",namHocDuocChon:"",hocKyDuocChon:"",danhSachNhiemVu:[],danhSachNamHoc:[],tuKhoaTimKiem:"",ketQuaTimKiem:[],duocThem:!1}},watch:{namHocDuocChon(n){this.updateDuocThem()},hocKyDuocChon(){this.updateDuocThem()},HocKy(){this.updateDuocThem()},NamHoc(){this.updateDuocThem()}},async created(){await this.lay_nam_hoc_va_hoc_ky(),await this.hien_danh_sach_nhiem_vu(),await this.hien_danh_sach_nam_hoc()},methods:{updateDuocThem(){const n=V(this.NamHoc,this.namHocDuocChon);if(n=="nam_truoc")this.duocThem=!1;else if(n=="nam_sau")this.duocThem=!0;else if(n=="nam_hien_tai"){const o=parseInt(this.HocKy)||0,c=parseInt(this.hocKyDuocChon)||0;this.duocThem=c>=o}else this.duocThem=!1},async lay_nam_hoc_va_hoc_ky(){try{this.NamHoc=await K(),this.HocKy=await T()}catch(n){console.log("Lá»—i láº¥y nÄƒm há»c vÃ  há»c ká»³: ",n)}},async hien_danh_sach_nhiem_vu(){try{const n=await _.get(`${p}/nhiem-vu/danh-sach-nhiem-vu`);n.data.success&&(this.danhSachNhiemVu=n.data.data)}catch(n){throw console.log(n),n}},async hien_danh_sach_nam_hoc(){try{const n=await _.get(`${p}/nam-hoc/danh-sach-nam-hoc`);n.data.success&&(this.danhSachNamHoc=n.data.data)}catch(n){throw console.log(n),n}},async goi_api_tim_giao_vien(){this.hienKetQua=!0,this.MaGV="";try{const n=await _.get(`
                    ${p}/giao-vien/tim-giao-vien?keyword=${this.tuKhoaTimKiem}
                `);n.data.success&&(this.ketQuaTimKiem=n.data.data)}catch(n){throw console.log("Lá»—i tÃ¬m gv: ",n),n}},them_vao_the_input(n){this.MaGV=n},reset(){this.hienKetQua=!1,this.tuKhoaTimKiem="",this.ketQuaTimKiem="",this.MaGV="",this.MaNV=""},them_kiem_nhiem(){if(!this.duocThem){u.fire({title:"ThÃ´ng tin khÃ´ng há»£p lá»‡!",text:"Vui lÃ²ng chá»n nÄƒm há»c há»£p lá»‡, khÃ´ng thá»ƒ chá»n nÄƒm há»c - há»c ká»³ cÅ©",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6"}),console.log(this.NamHoc),console.log(this.namHocDuocChon);return}if(!this.MaGV||!this.MaNV){u.fire({title:"Thiáº¿u thÃ´ng tin!",text:"Vui lÃ²ng nháº­p Ä‘á»§ thÃ´ng tin trÆ°á»›c khi lÆ°u.",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6"});return}const n={MaGV:this.MaGV.toUpperCase(),MaNV:this.MaNV,HocKy:this.hocKyDuocChon,NamHoc:this.namHocDuocChon};console.log(n),this.$emit("save",n),this.reset()}}},D={key:0,class:"modal-overlay"},x={class:"add-modal"},B={class:"add-modal__content"},S={key:0,for:""},G={class:"container__table"},L={border:"1"},Q=["onClick"],U={for:""},P={for:""},X=["value"],I={key:0},O={for:""},$=["value"],A={for:""},E={class:"modal-actions"};function F(n,o,c,y,i,l){return c.isOpen?(s(),h("div",D,[t("div",x,[t("div",B,[o[19]||(o[19]=t("h2",null,"ThÃªm kiÃªm nhiá»‡m",-1)),t("label",null,[o[8]||(o[8]=r(" TÃ¬m giÃ¡o viÃªn: ")),d(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.tuKhoaTimKiem=e),type:"text",placeholder:"Nháº­p mÃ£ giÃ¡o viÃªn hoáº·c tÃªn giÃ¡o viÃªn"},null,512),[[N,i.tuKhoaTimKiem]]),t("button",{id:"search-button",onClick:o[1]||(o[1]=(...e)=>l.goi_api_tim_giao_vien&&l.goi_api_tim_giao_vien(...e))},"ğŸ”")]),i.hienKetQua?(s(),h("label",S,[o[10]||(o[10]=r(" Káº¿t quáº£: ")),t("div",G,[t("table",L,[o[9]||(o[9]=t("thead",null,[t("tr",null,[t("th",null,"STT"),t("th",null,"MÃ£ giÃ¡o viÃªn"),t("th",null,"TÃªn giÃ¡o viÃªn"),t("th",null,"MÃ£ bá»™ mÃ´n"),t("th",null,"TÃªn bá»™ mÃ´n"),t("th",null,"Chá»n")])],-1)),t("tbody",null,[(s(!0),h(g,null,k(i.ketQuaTimKiem,(e,a)=>(s(),h("tr",{key:e.MaGV},[t("td",null,m(a+1),1),t("td",null,m(e.MaGV),1),t("td",null,m(e.HoTenGV),1),t("td",null,m(e.MaBM),1),t("td",null,m(e.TenBM),1),t("td",null,[t("button",{id:"add-button",onClick:v=>l.them_vao_the_input(e.MaGV),title:"Chá»n giÃ¡o viÃªn nÃ y"},"â•",8,Q)])]))),128))])])])])):f("",!0),t("label",U,[o[11]||(o[11]=r(" Nháº­p mÃ£ giÃ¡o viÃªn: ")),d(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>i.MaGV=e),type:"text",name:"",id:"",placeholder:"Nháº­p mÃ£ giÃ¡o viÃªn muá»‘n phÃ¢n cÃ´ng"},null,512),[[N,i.MaGV]])]),t("label",P,[o[14]||(o[14]=r(" Chá»n nhiá»‡m vá»¥: ")),d(t("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>i.MaNV=e),name:"",id:""},[o[12]||(o[12]=t("option",{disabled:"",value:""},"-- Chá»n nhiá»‡m vá»¥ --",-1)),(s(!0),h(g,null,k(i.danhSachNhiemVu,e=>(s(),h("option",{key:e.MaNV,value:e.MaNV},m(e.TenNV),9,X))),128))],512),[[C,i.MaNV]]),n.phanCongChuNhiem?(s(),h("div",I,o[13]||(o[13]=[t("p",null,[t("span",{class:"alert-text"},"LÆ¯U Ã:"),r(" Náº¿u báº¡n phÃ¢n cÃ´ng chá»§ nhiá»‡m cho giÃ¡o viÃªn, há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng phÃ¢n cÃ´ng cho cáº£ nÄƒm ")],-1)]))):f("",!0)]),t("label",O,[o[16]||(o[16]=r(" NÄƒm há»c: ")),d(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>i.namHocDuocChon=e),name:"",id:""},[o[15]||(o[15]=t("option",{disabled:"",value:""},"-- Chá»n nÄƒm há»c --",-1)),(s(!0),h(g,null,k(i.danhSachNamHoc,e=>(s(),h("option",{key:e.NamHoc,value:e.NamHoc},m(e.NamHoc),9,$))),128))],512),[[C,i.namHocDuocChon]])]),t("label",A,[o[18]||(o[18]=r(" Há»c ká»³: ")),d(t("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>i.hocKyDuocChon=e),name:"",id:""},o[17]||(o[17]=[t("option",{disabled:"",value:""},"-- Chá»n há»c ká»³ --",-1),t("option",{value:"1"},"1",-1),t("option",{value:"2"},"2",-1)]),512),[[C,i.hocKyDuocChon]])]),t("div",E,[t("button",{onClick:o[6]||(o[6]=e=>n.$emit("close"))},"ÄÃ³ng"),t("button",{onClick:o[7]||(o[7]=(...e)=>l.them_kiem_nhiem&&l.them_kiem_nhiem(...e))},"ThÃªm")])])])])):f("",!0)}const q=H(w,[["render",F],["__scopeId","data-v-4cb4f8c6"]]),z={components:{ThemKiemNhiemVue:q},data(){return{NamHoc:"",HocKy:"",danhSachKiemNhiem:[],danhSachNamHoc:[],hienModalThem:!1,hocKyDuocChon:"",namHocDuocChon:"",duocXoa:!1}},async created(){await this.lay_nam_hoc_va_hoc_ky(),await this.hien_danh_sach_nam_hoc()},methods:{async lay_nam_hoc_va_hoc_ky(){try{this.NamHoc=await K(),this.HocKy=await T(),this.hocKyDuocChon=this.HocKy,this.namHocDuocChon=this.NamHoc}catch(n){console.log("Lá»—i láº¥y nÄƒm há»c vÃ  há»c ká»³: ",n)}},async hien_danh_sach_nam_hoc(){try{const n=await _.get(`${p}/nam-hoc/danh-sach-nam-hoc`);n.data.success&&(this.danhSachNamHoc=n.data.data)}catch(n){throw console.log(n),n}},async hien_danh_sach_kiem_nhiem(n,o){try{const c=await _.get(`${p}/kiem-nhiem/danh-sach-kiem-nhiem?HocKy=${n}&NamHoc=${o}`);if(c.data){this.danhSachKiemNhiem=c.data.data;const y=V(this.NamHoc,o);this.duocXoa=y=="nam_hien_tai"&&n==this.HocKy||y=="nam_sau"}}catch(c){throw console.log("Lá»—i láº¥y API giá»¯ chá»©c vá»¥",c),c}},async goi_api_them_kiem_nhiem(n){try{const o={...n};(await _.post(`${p}/kiem-nhiem/them-kiem-nhiem`,o)).data.success?(u.fire({icon:"success",title:"ThÃªm thÃ nh cÃ´ng!",text:"Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o há»‡ thá»‘ng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}}),this.hienModalThem=!1,await this.hien_danh_sach_kiem_nhiem(this.hocKyDuocChon,this.namHocDuocChon)):u.fire({icon:"error",title:"ThÃªm tháº¥t báº¡i!",text:"KhÃ´ng thá»ƒ thÃªm dá»¯ liá»‡u vÃ o há»‡ thá»‘ng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#fff1f2",iconColor:"#e74c3c",customClass:{popup:"error-toast",title:"error-title",content:"error-content"}})}catch(o){console.error("Chi tiáº¿t lá»—i:",o),u.fire("Lá»—i!","CÃ³ lá»—i xáº£y ra khi thÃªm dá»¯ liá»‡u!")}},async goi_api_xoa_kiem_nhiem(n,o,c,y){if((await u.fire({title:"XÃ¡c nháº­n xÃ³a",text:"Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a dá»¯ liá»‡u nÃ y khÃ´ng?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"XÃ³a",cancelButtonText:"Há»§y"})).isConfirmed)try{(await _.delete(`
                        ${p}/kiem-nhiem/xoa-kiem-nhiem?MaGV=${n}&MaNV=${o}&HocKy=${c}&NamHoc=${y}
                    `)).data.success?(u.fire({icon:"success",title:"XÃ³a thÃ nh cÃ´ng!",text:"Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c xÃ³a khá»i há»‡ thá»‘ng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}}),await this.hien_danh_sach_kiem_nhiem(this.hocKyDuocChon,this.namHocDuocChon)):u.fire({icon:"error",title:"XÃ³a tháº¥t báº¡i!",text:"KhÃ´ng thá»ƒ xÃ³a dá»¯ liá»‡u khá»i há»‡ thá»‘ng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#fff1f2",iconColor:"#e74c3c",customClass:{popup:"error-toast",title:"error-title",content:"error-content"}})}catch(l){console.log(l),u.fire("Lá»—i!","CÃ³ lá»—i xáº£y ra khi xÃ³a dá»¯ liá»‡u!")}},mo_modal_them_kiem_nhiem(){this.hienModalThem=!0},dong_modal_them_kiem_nhiem(){this.hienModalThem=!1}}},R={class:"container"},j={class:"container__action"},J={class:"container__add"},W={class:"container__filter"},Y=["value"],Z={class:"container__table"},oo={border:"1"},to={key:0},no=["onClick"];function eo(n,o,c,y,i,l){const e=b("them-kiem-nhiem-vue");return s(),h("div",R,[o[11]||(o[11]=t("h1",null,"PhÃ¢n cÃ´ng kiÃªm nhiá»‡m",-1)),t("div",j,[t("div",J,[o[4]||(o[4]=t("b",null,"PhÃ¢n cÃ´ng má»›i",-1)),t("button",{onClick:o[0]||(o[0]=(...a)=>l.mo_modal_them_kiem_nhiem&&l.mo_modal_them_kiem_nhiem(...a))},"â•")]),t("div",W,[o[7]||(o[7]=t("b",null,"Há»c ká»³",-1)),d(t("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>i.hocKyDuocChon=a),name:"",id:""},o[5]||(o[5]=[t("option",{disabled:"",value:""},"Chá»n há»c ká»³",-1),t("option",{value:"1"},"1",-1),t("option",{value:"2"},"2",-1)]),512),[[C,i.hocKyDuocChon]]),o[8]||(o[8]=t("b",null,"NÄƒm há»c",-1)),d(t("select",{"onUpdate:modelValue":o[2]||(o[2]=a=>i.namHocDuocChon=a),name:"",id:""},[o[6]||(o[6]=t("option",{disabled:"",value:""},"Chá»n nÄƒm há»c",-1)),(s(!0),h(g,null,k(i.danhSachNamHoc,a=>(s(),h("option",{key:a.NamHoc,value:a.NamHoc},m(a.NamHoc),9,Y))),128))],512),[[C,i.namHocDuocChon]]),t("button",{id:"filter-button",onClick:o[3]||(o[3]=a=>l.hien_danh_sach_kiem_nhiem(this.hocKyDuocChon,this.namHocDuocChon))}," Liá»‡t kÃª ")]),M(e,{isOpen:i.hienModalThem,hocky:parseInt(this.HocKy),namhoc:this.NamHoc,onClose:l.dong_modal_them_kiem_nhiem,onSave:l.goi_api_them_kiem_nhiem},null,8,["isOpen","hocky","namhoc","onClose","onSave"])]),t("div",Z,[t("table",oo,[o[10]||(o[10]=t("thead",null,[t("tr",null,[t("th",null,"STT"),t("th",null,"MÃ£ giÃ¡o viÃªn"),t("th",null,"TÃªn giÃ¡o viÃªn"),t("th",null,"MÃ£ nhiá»‡m vá»¥"),t("th",null,"TÃªn nhiá»‡m vá»¥"),t("th",null,"XÃ³a")])],-1)),t("tbody",null,[i.danhSachKiemNhiem.length===0?(s(),h("tr",to,o[9]||(o[9]=[t("td",{colspan:"6"},"KhÃ´ng cÃ³ dá»¯ liá»‡u kiÃªm nhiá»‡m cho há»c ká»³ vÃ  nÄƒm há»c Ä‘Ã£ chá»n.",-1)]))):f("",!0),(s(!0),h(g,null,k(i.danhSachKiemNhiem,(a,v)=>(s(),h("tr",{key:`${a.MaGV}-${a.MaNV}`},[t("td",null,m(v+1),1),t("td",null,m(a.MaGV),1),t("td",null,m(a.HoTenGV),1),t("td",null,m(a.MaNV),1),t("td",null,m(a.TenNV),1),t("td",null,[i.duocXoa?(s(),h("button",{key:0,onClick:io=>l.goi_api_xoa_kiem_nhiem(a.MaGV,a.MaNV,a.HocKy,a.NamHoc)}," ğŸ—‘ï¸ ",8,no)):f("",!0)])]))),128))])])])])}const so=H(z,[["render",eo],["__scopeId","data-v-ddf5233a"]]);export{so as default};
