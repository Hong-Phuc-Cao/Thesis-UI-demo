import{_ as v,S as u,b as r,A as d,c as l,d as g,a as t,e as f,w as _,f as y,v as k,F as H,g as C,o as c,t as p,y as T,z as K}from"./index-DsFX8v4I.js";import{l as N,s as L,a as w}from"./so-sanh-nam-s7tHrirU.js";/* empty css                   */const x={props:{isOpen:Boolean},data(){return{MaGV:"",Khoi:"",KyHieu:"",SoLuong:0,danhSachNamhoc:[],NamHoc:"",namHocDuocChon:"",duocThem:!1,danhSachLopTheoKhoiVaKyHieu:[],tongLopTheoKhoiVaKyHieu:""}},async created(){await this.lay_nam_hoc_va_hoc_ky(),await this.hien_danh_sach_nam_hoc()},watch:{namHocDuocChon(n){const o=L(this.NamHoc,n);this.duocThem=o=="nam_hien_tai"||o=="nam_sau"}},methods:{async lay_nam_hoc_va_hoc_ky(){try{this.NamHoc=await N(),this.HocKy=await lay_hoc_ky()}catch(n){console.log("L·ªói l·∫•y nƒÉm h·ªçc v√† h·ªçc k·ª≥: ",n)}},async hien_danh_sach_nam_hoc(){try{const n=await r.get(`${d}/nam-hoc/danh-sach-nam-hoc`);n.data.success&&(this.danhSachNamHoc=n.data.data)}catch(n){throw console.log(n),n}},async lay_danh_sach_lop_theo_khoi_va_ky_hieu(){try{const n=await r.get(`
                    ${d}/lop/danh-sach-lop-theo-khoi-va-ky-hieu?NamHoc=${this.namHocDuocChon}&Khoi=${this.Khoi}&KyHieu=${this.KyHieu}
                `);n.data.success&&(this.danhSachLopTheoKhoiVaKyHieu=n.data.data,this.tongLopTheoKhoiVaKyHieu=n.data.tongLop)}catch(n){console.log("L·ªói l·∫•y danh sach l·ªõp theo kh·ªëi v√† k√Ω hi·ªáu: ",n)}},async them_lop_hang_loat(){if(!this.Khoi||!this.KyHieu||this.SoLuong<1){u.fire({title:"Thi·∫øu th√¥ng tin!",text:"Vui l√≤ng nh·∫≠p ƒë·ªß th√¥ng tin tr∆∞·ªõc khi l∆∞u.",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6"});return}if(!this.duocThem){u.fire({title:"Th√¥ng tin kh√¥ng h·ª£p l·ªá!",text:"Vui l√≤ng ch·ªçn nƒÉm h·ªçc h·ª£p l·ªá, kh√¥ng th·ªÉ ch·ªçn nƒÉm h·ªçc c≈©",icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#3085d6"});return}await this.lay_danh_sach_lop_theo_khoi_va_ky_hieu();let n;try{const o=this.tongLopTheoKhoiVaKyHieu+1;for(let h=o;h<o+this.SoLuong;h++){const m={STTLop:h,Khoi:this.Khoi,KyHieu:this.KyHieu,NamHoc:this.namHocDuocChon,MaGV:null};console.log(m),n=await r.post(`${d}/lop/them-lop`,m)}n.data.success?(u.fire({icon:"success",title:"Th√™m th√†nh c√¥ng!",text:"D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c th√™m v√†o h·ªá th·ªëng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}}),this.$emit("close"),this.lam_moi_form()):u.fire({icon:"success",title:"Th√™m th√†nh c√¥ng!",text:"D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c th√™m v√†o h·ªá th·ªëng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}})}catch(o){console.error(o),u.fire("L·ªói!","C√≥ l·ªói x·∫£y ra khi th√™m d·ªØ li·ªáu!")}},lam_moi_form(){this.Khoi="",this.KyHieu="",this.SoLuong=0,this.namHocDuocChon=""}}},B={key:0,class:"modal-overlay"},$={class:"add-modal"},M={class:"add-modal__content"},D={for:""},G={for:""},O={for:""},P={for:""},X=["value"],U={class:"modal-actions"};function A(n,o,h,m,i,a){return h.isOpen?(c(),l("div",B,[t("div",$,[t("div",M,[o[13]||(o[13]=t("h2",null,"Th√™m l·ªõp",-1)),t("label",D,[o[7]||(o[7]=f(" Kh·ªëi: ")),_(t("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.Khoi=e),name:"",id:""},o[6]||(o[6]=[t("option",{disabled:"",value:""},"-- Ch·ªçn kh·ªëi --",-1),t("option",{value:"10"},"10",-1),t("option",{value:"11"},"11",-1),t("option",{value:"12"},"12",-1)]),512),[[y,i.Khoi]])]),t("label",G,[o[9]||(o[9]=f(" K√Ω hi·ªáu: ")),_(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.KyHieu=e),name:"",id:""},o[8]||(o[8]=[t("option",{disabled:"",value:""},"-- Ch·ªçn k√Ω hi·ªáu --",-1),t("option",{value:"A"},"A",-1),t("option",{value:"P"},"P",-1)]),512),[[y,i.KyHieu]])]),t("label",O,[o[10]||(o[10]=f(" Nh·∫≠p s·ªë l∆∞·ª£ng l·ªõp: ")),_(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>i.SoLuong=e),type:"number",min:"1",placeholder:"Nh·∫≠p s·ªë l∆∞·ª£ng l·ªõp mu·ªën t·∫°o"},null,512),[[k,i.SoLuong]])]),t("label",P,[o[12]||(o[12]=f(" NƒÉm h·ªçc: ")),_(t("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>i.namHocDuocChon=e),name:"",id:""},[o[11]||(o[11]=t("option",{disabled:"",value:""},"-- Ch·ªçn nƒÉm h·ªçc --",-1)),(c(!0),l(H,null,C(n.danhSachNamHoc,e=>(c(),l("option",{key:e.NamHoc,value:e.NamHoc},p(e.NamHoc),9,X))),128))],512),[[y,i.namHocDuocChon]])]),t("div",U,[t("button",{onClick:o[4]||(o[4]=e=>n.$emit("close"))},"ƒê√≥ng"),t("button",{onClick:o[5]||(o[5]=(...e)=>a.them_lop_hang_loat&&a.them_lop_hang_loat(...e))},"Th√™m")])])])])):g("",!0)}const I=v(x,[["render",A],["__scopeId","data-v-385b25a9"]]),E={props:{isOpen:Boolean,Lop:Object},data(){return{MaGV:"",danhSachGiaoVienChuNhiem:[],MaNV:"NV006",NamHoc:"",TenLop:"",STTLop:"",Khoi:"",KyHieu:""}},watch:{Lop:{immediate:!0,deep:!0,handler(n){n&&(this.NamHoc=n.NamHoc||"",this.TenLop=n.TenLop||"",this.STTLop=n.STTLop||"",this.KyHieu=n.KyHieu||"",this.Khoi=n.Khoi||"")}},isOpen(n){n&&this.NamHoc?this.hien_danh_sach_giao_vien_chu_nhiem():this.danhSachGiaoVienChuNhiem=[]}},methods:{async hien_danh_sach_giao_vien_chu_nhiem(){console.log("NamHoc:",this.NamHoc);try{const n=await r.get(`
                    ${d}/kiem-nhiem/danh-sach-giao-vien-chu-nhiem?MaNV=${this.MaNV}&NamHoc=${this.NamHoc}
                `);n.data.success&&(this.danhSachGiaoVienChuNhiem=n.data.data)}catch(n){console.log("L·ªói l·∫•y danh s√°ch GVCN:",n)}},luu_thong_tin(){const n={MaGV:this.MaGV},o={STTLop:this.STTLop,Khoi:this.Khoi,KyHieu:this.KyHieu,NamHoc:this.NamHoc};this.$emit("save",{request_body:n,request_query:o})}}},F={key:0,class:"modal-overlay"},Q={class:"edit-modal"},j={class:"edit-modal__content"},z={for:""},J={for:""},R=["value"],W={class:"modal-actions"};function Y(n,o,h,m,i,a){return h.isOpen?(c(),l("div",F,[t("div",Q,[t("div",j,[o[7]||(o[7]=t("h2",null,"S·ª≠a l·ªõp h·ªçc",-1)),t("label",z,[o[4]||(o[4]=f(" T√™n l·ªõp: ")),_(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>i.TenLop=e),disabled:"",type:"text"},null,512),[[k,i.TenLop]])]),t("label",J,[o[6]||(o[6]=f(" GVCN: ")),_(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>i.MaGV=e),name:"",id:""},[o[5]||(o[5]=t("option",{disabled:"",value:""},"-- Ch·ªçn GVCN --",-1)),(c(!0),l(H,null,C(i.danhSachGiaoVienChuNhiem,e=>(c(),l("option",{key:e.MaGV,value:e.MaGV},p(e.HoTenGV),9,R))),128))],512),[[y,i.MaGV]])]),t("div",W,[t("button",{onClick:o[2]||(o[2]=e=>n.$emit("close"))},"ƒê√≥ng"),t("button",{onClick:o[3]||(o[3]=(...e)=>a.luu_thong_tin&&a.luu_thong_tin(...e))},"L∆∞u")])])])])):g("",!0)}const Z=v(E,[["render",Y]]),q={components:{ThemLopModalVue:I,SuaLopModalVue:Z},data(){return{NamHoc:"",HocKy:"",danhSachLop:[],danhSachNamHoc:[],hienModalThem:!1,hienModalSua:!1,hocKyDuocChon:"",namHocDuocChon:"",duocXoa:!1,lopDangChinhSua:null}},async created(){await this.lay_nam_hoc_va_hoc_ky(),await this.hien_danh_sach_nam_hoc()},methods:{async lay_nam_hoc_va_hoc_ky(){try{this.NamHoc=await N(),this.HocKy=await w()}catch(n){console.log("L·ªói l·∫•y nƒÉm h·ªçc v√† h·ªçc k·ª≥: ",n)}},async hien_danh_sach_nam_hoc(){try{const n=await r.get(`${d}/nam-hoc/danh-sach-nam-hoc`);n.data.success&&(this.danhSachNamHoc=n.data.data)}catch(n){throw console.log(n),n}},async hien_danh_sach_lop(n){try{const o=await r.get(`${d}/lop/danh-sach-lop?NamHoc=${n}`);if(o.data.success){this.danhSachLop=o.data.data;const h=L(this.NamHoc,n);this.duocXoa=h=="nam_hien_tai"||h=="nam_sau"}}catch(o){throw console.log("L·ªói l·∫•y API l·∫•y DS l·ªõp",o),o}},async goi_api_sua_lop({request_body:n,request_query:o}){try{(await r.put(`${d}/lop/sua-lop?STTLop=${o.STTLop}&Khoi=${o.Khoi}&KyHieu=${o.KyHieu}&NamHoc=${o.NamHoc}`,n)).data.success?(await this.hien_danh_sach_lop(this.namHocDuocChon),u.fire({icon:"success",title:"S·ª≠a th√†nh c√¥ng!",text:"D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}}),this.dong_modal_sua_lop()):u.fire({icon:"error",title:"S·ª≠a th·∫•t b·∫°i!",text:"Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#fff1f2",iconColor:"#e74c3c",customClass:{popup:"error-toast",title:"error-title",content:"error-content"}})}catch(h){console.error("L·ªói khi s·ª≠a l·ªõp:",h),u.fire("L·ªói","Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t l·ªõp!","error")}},async goi_api_xoa_lop(n,o,h,m){if((await u.fire({title:"X√°c nh·∫≠n x√≥a",text:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ªØ li·ªáu n√†y kh√¥ng?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"X√≥a",cancelButtonText:"H·ªßy"})).isConfirmed)try{(await r.delete(`
                        ${d}/lop/xoa-lop?STTLop=${n}&Khoi=${o}&KyHieu=${h}&NamHoc=${m}
                    `)).data.success?(u.fire({icon:"success",title:"X√≥a th√†nh c√¥ng!",text:"D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x√≥a kh·ªèi h·ªá th·ªëng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#f0fff4",iconColor:"#2ecc71",customClass:{popup:"success-toast",title:"success-title",content:"success-content"}}),this.hien_danh_sach_lop(this.namHocDuocChon)):u.fire({icon:"error",title:"X√≥a th·∫•t b·∫°i!",text:"Kh√¥ng th·ªÉ x√≥a d·ªØ li·ªáu kh·ªèi h·ªá th·ªëng.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,toast:!0,position:"top-end",background:"#fff1f2",iconColor:"#e74c3c",customClass:{popup:"error-toast",title:"error-title",content:"error-content"}})}catch(a){console.log("L·ªói khi x√≥a l·ªõp:",a),u.fire("L·ªói!","C√≥ l·ªói x·∫£y ra khi x√≥a d·ªØ li·ªáu!")}},mo_modal_them_lop(){this.hienModalThem=!0},dong_modal_them_lop(){this.hienModalThem=!1},mo_modal_sua_lop(n){this.lopDangChinhSua={...n},this.hienModalSua=!0},dong_modal_sua_lop(){this.hienModalSua=!1}}},oo={class:"container"},to={class:"container__action"},no={class:"container__add"},eo={class:"container__filter"},io=["value"],so={class:"container__table"},ao={border:"1"},ho=["onClick"],lo=["onClick"];function co(n,o,h,m,i,a){const e=K("them-lop-modal-vue"),S=K("sua-lop-modal-vue");return c(),l("div",oo,[o[7]||(o[7]=t("h1",null,"L·ªõp",-1)),t("div",to,[t("div",no,[o[3]||(o[3]=t("b",null,"Th√™m nhi·ªÅu l·ªõp",-1)),t("button",{onClick:o[0]||(o[0]=(...s)=>a.mo_modal_them_lop&&a.mo_modal_them_lop(...s))},"‚ûï")]),t("div",eo,[o[5]||(o[5]=t("b",null,"NƒÉm h·ªçc",-1)),_(t("select",{"onUpdate:modelValue":o[1]||(o[1]=s=>i.namHocDuocChon=s),name:"",id:""},[o[4]||(o[4]=t("option",{disabled:"",value:""},"Ch·ªçn nƒÉm h·ªçc",-1)),(c(!0),l(H,null,C(i.danhSachNamHoc,s=>(c(),l("option",{key:s.NamHoc,value:s.NamHoc},p(s.NamHoc),9,io))),128))],512),[[y,i.namHocDuocChon]]),t("button",{id:"filter-button",onClick:o[2]||(o[2]=s=>a.hien_danh_sach_lop(this.namHocDuocChon))}," Li·ªát k√™ ")]),T(e,{isOpen:i.hienModalThem,onClose:a.dong_modal_them_lop},null,8,["isOpen","onClose"])]),t("div",so,[t("table",ao,[o[6]||(o[6]=t("thead",null,[t("tr",null,[t("th",null,"STT"),t("th",null,"T√™n l·ªõp"),t("th",null,"T√™n GVCN"),t("th",null,"M√£ GVCN"),t("th",null,"S·ª≠a"),t("th",null,"X√≥a")])],-1)),t("tbody",null,[(c(!0),l(H,null,C(i.danhSachLop,(s,b)=>(c(),l("tr",{key:JSON.stringify([s.STTLop,s.KyHieu,s.Khoi,s.NamHoc])},[t("td",null,p(b+1),1),t("td",null,p(s.TenLop),1),t("td",null,p(s.HoTenGV),1),t("td",null,p(s.MaGV),1),t("td",null,[i.duocXoa?(c(),l("button",{key:0,onClick:V=>a.mo_modal_sua_lop(s)}," ‚úèÔ∏è ",8,ho)):g("",!0)]),t("td",null,[i.duocXoa?(c(),l("button",{key:0,onClick:V=>a.goi_api_xoa_lop(s.STTLop,s.Khoi,s.KyHieu,s.NamHoc)}," üóëÔ∏è ",8,lo)):g("",!0)])]))),128))])]),T(S,{isOpen:i.hienModalSua,Lop:i.lopDangChinhSua,onSave:a.goi_api_sua_lop,onClose:a.dong_modal_sua_lop},null,8,["isOpen","Lop","onSave","onClose"])])])}const po=v(q,[["render",co],["__scopeId","data-v-3c9b744c"]]);export{po as default};
